This docker integration based on the python wrapper of idengine library and consist with two scripts - idengine_server.py from the docker side and client.py from the local side. Both scripts use sockets to interact with each other, all requests and responses use json formatting. Here you can find the short description of all functions from both scripts.


The "client.py":
 
    This client send settings object to the server and return recognition result in json file.

    Example: python3 client.py  -mask "mrz.mrp" -s=YOUR_SIGNATURE_HERE --image_path="./Smart-ID-Engine/testdata/mrz_passport_2.jpg"
    
    Arguments:

    --mask - Document mask. [default "*"]
    --mode - Engine mode. [default "default"]
    --signature - *required*. Licencse key.
    --image_path - *required*. Path to local image.
    --output - Output folder for result. [default "./result"]
    --forensics - If you want to check forensics data. This option must be enabled with `"common.currentDate": "DD.MM.YYYY"` in `options`forensics data. [default false]
    --endpoint - server ip adress
    --port - Port of your server endpoint. [default 53000]


    Methods:

	async def save_result(data) - Create folder and save result as json file
    async def tcp_client(settings) - Connect to async sockets. Encode data for transmission and Decode for result. Result will be saved in a folder.
    

    Response:

    {
        "error":false,
        "response":{
            "docType":"mrz.mrp",
            "fields":{
                "full_mrz":{
                    "name":"full_mrz",
                    "value":"P<CANMARTIN<<SARAH<<<08",
                    "isAccepted":true,
                    "attr":{
                    "control_digit_check":"passed"
                    }
                },
                "mrz_birth_date":{
                    "name":"mrz_birth_date",
                    "value":"01.01.1985",
                    "isAccepted":true,
                    "attr":{
                    "control_digit_check":"passed"
                    }
                },
                "mrz_gender":{
                    "name":"mrz_gender",
                    "value":"F",
                    "isAccepted":true
                }
            }
        }
    }


    Response with exceptions:

    {
        "error": true,
        "desc": "<exception_description>"
    }


    The request generated by client.py scripts:

    {
        'mode': 'default',
        'mask': ['*'],
        'options':{
            'common.currentDate': '08.09.2022'
            },
        'input': b'...',
        'signature': '<here_your_signature_from_doc/README.html>'
    }



The "idengine_server.py" script:

    This file listen for connections and wait for recognition request.


    Arguments:

    --bundle_dir - *required* - path to bundle.
    --lazy - IdEngine lazy mode. Not recommended for server.
    --concur - Concurrency. All CPU cores enabled by default.
    --port` - Server port. [default 53000]


    Methods:

async def main() - Create async sockets.
def initEngine() - init recognition engine with the bundle from the args.
async def startRecognition(inputData) - create the session settings, recognition session and perform the recognition.
def RecognitionResult(recog_result) - parse the output object from the recognition session and prepare it for sending to the client    
async def send_result(result, writer) - send the recognition result to the client.
async def handle_echo(reader, writer) - handle the connection with the client

